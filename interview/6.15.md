## react 生命周期

- 挂载时
  - constructor
  - getDerivedStateFromProps: 将传入的 props 映射到 state 上面
  - render
  - 渲染 dom 和 refs
  - componentDidMount
- 更新时
  - New Props、setState、forceUpdate
  - getDerivedStateFromProps: 将传入的 props 映射到 state 上面
  - shouldComponentUpdate(nextProps 和 nextState) => (props 和 state 改变时会调用)
  - render
  - getSnapshotBeforeUpdate: 相当于 beforeUpdate 返回值将作为 componentDidUpdate 的参数
  - 更新 dom 和 refs
  - componentDidUpdate
- 卸载时
  - componentWillUnMount
- 已经废弃的
  - 3 个
    - componentWillMount(挂载时 render 之前)
    - componentWillReactiveProps
    - componentWillUpdate(更新时 render 之前)
  - render 阶段 commit 阶段
  - 被删除的都是 render 阶段的
  - 被删除原因
    - 可能会被执行多次 造成副作用(网络请求)

## react hooks

- 只能在函数组件中使用
- useState
  - `const [state, setState] = useState(initialState);`
  - 接收一个初始化 state 或 函数
- useReducer
  - `const [state, dispatch] = useReducer(reducer, initialArg, init);`
  - reducer => dispatch 调用函数
  - initialArg => 初始化状态
  - init => 状态处理函数
- useEffect => effect
  - `useEffect(cb, [prop])`
- useLayoutEffect
  - 会在 dom 变更之后同步调用 effect
- useContext => inject
  - `let {state,dispatch} = useContext(React.createContext())`
  - 接收 上级 Provider 提供的数据
- useMemo
- useCallback
- useRef => ref
  - current 会被设置成初始值
  - 如果在子组件上使用 将会被传入到子组件中
  ```js
  function Child(props, ref) {
    return <input type="text" ref={ref} />
  }
  ```
- useImperativeHandle

  - 可以将子组件的方法暴露给父组件

- 路由 hook
  - useParams
  - useRouteMatch
  - useLocation
  - useHistory

## vuex 原理

- 返回一个 Store 实例

  - install
  - commit
  - dispatch

- 1.根据传入的 options 组装模块关系 返回对象 有一个 root 属性 根状态 都有一个 \_children 挂载子模块
- 2.组装数据
  - state: 嵌套模式
  - getters: `_wrappedGetters[path]`
  - mutations: `_mutations[path]`
  - actions: `_actions[path]`
- 3.处理 state
  - 将 state 响应式 `reactive{data: state}`
  - 定义 getters 属性 使用 defineProperty
- 4.执行插件

## vue3 与 vue2 的区别

- 源码结构
- 全局采用 TS 编写
- 数据劫持原理
- composition API
- 新的内置组件
  - teleport: 穿梭组件
    - 将组件挂载到指定的选择器上
  - suspense: 异步组件
    - setup 函数返回一个 Promise1
- 自定义渲染器

## 异步队列

- 宏任务 => 微任务 => GUI 渲染
- 宏任务: script 脚本、setTimeout、setInterval
- 微任务: promise.then、MutationObserver (promise.nextTick)

## vite

- 使用 esbuild
- 替换模块路径

## 微前端
